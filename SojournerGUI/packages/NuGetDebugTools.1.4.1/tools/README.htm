<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<h1>NuGetDebugTools - PowerShell Scripts</h1>
<h2>Introduction</h2>
<p>Simple and yet effective script debugging, tracing, coverage, and other tools. They are designed for any PowerShell host and may be used in the NuGet console for debugging and testing NuGet and Visual Studio specific scripts.</p>
<h2>The Package</h2>
<p><em>Add-Debugger.ps1</em> - Adds a simple debugger to PowerShell. As far as the NuGet console does not provide its own debugger, this script comes to rescue. It can be also used for debugging with custom or default hosts, e.g. on invoking PowerShell code from .NET code.</p>
<p><em>Trace-Debugger.ps1</em> - This script is the alternative to <code>Set-PSDebug -Trace</code>. It avoids some known <code>Set-PSDebug</code> V3 issues and provides extra features. It is useful in any host for troubleshooting and collecting data for script coverage analysis.</p>
<p><em>Show-Coverage.ps1</em> - It is used together with <em>Trace-Debugger.ps1</em> in order to convert coverage data to HTML and visualize script coverage information.</p>
<p><em>Debug-Error.ps1</em> - Enables debugging on terminating errors. PowerShell does not provide a way to break into debugger on errors. This script enables this feature by exploiting a known fact about the automatic variable <code>StackTrace</code>. Designed for any host with a debugger.</p>
<p><em>Test-Debugger.ps1</em> - Tests PowerShell debugging with breakpoints. It is suitable for playing with any debugger though it is designed for custom debuggers like <em>Add-Debugger.ps1</em>.</p>
<h2>Installation</h2>
<p>To install the tools for a Visual Studio solution, in the package manager console invoke the usual command:</p>
<pre><code>Install-Package NuGetDebugTools</code></pre>
<p>As a result, the package directory <em>tools</em> with scripts is added to the path and the scripts can be invoked just by names.</p>
<p>Alternatively, the scripts can be placed anywhere in the path permanently in order to make them available in package manager consoles for any solution, without a solution, and for other PowerShell hosts, too.</p>
<h2>Quick Start</h2>
<p>How to debug NuGet package scripts like <em>init.ps1</em>, <em>install.ps1</em>, and etc.?</p>
<p>Start Visual Studio. Open the NuGet console and add the debugger:</p>
<pre><code>Add-Debugger</code></pre>
<p>Or invoke this with the switch <code>-ReadHost</code> in order to use <code>Read-Host</code> for input instead of the default input box:</p>
<pre><code>Add-Debugger -ReadHost</code></pre>
<p>Then set some breakpoints, see <code>help Set-PSBreakpoint</code>. For example:</p>
<pre><code>Set-PSBreakpoint -Command init.ps1, install.ps1, uninstall.ps1</code></pre>
<p>Open a Visual Studio solution or invoke NuGet package commands for the already opened. The debugger prompt appears when the specified breakpoints are hit. Enter <code>?</code> and see what you can do:</p>
<pre><code>s, StepInto  Step to the next statement into functions, scripts, etc.
v, StepOver  Step to the next statement over functions, scripts, etc.
o, StepOut   Step out of the current function, script, etc.
c, Continue  Continue operation (also on empty input).
q, Quit      Stop operation and exit the debugger.
?, h         Write this help message.
k            Write call stack (Get-PSCallStack).
K            Write detailed call stack using Format-List.

&lt;n&gt;          Write debug location in context of &lt;n&gt; lines.
+&lt;n&gt;         Set location context preference to &lt;n&gt; lines.
k &lt;s&gt; &lt;n&gt;    Write source at stack &lt;s&gt; in context of &lt;n&gt; lines.

w            Restart watching the debugger output file.
r            Write last PowerShell commands invoked on debugging.
&lt;command&gt;    Invoke any PowerShell &lt;command&gt; and write its output.</code></pre>
<p>Type other debugger and PowerShell commands in order to step through the code, view source code lines, or get variable values and watch the output in the NuGet console window.</p>
<h2>The Project</h2>
<p>The scripts come from <a href="https://github.com/nightroman/PowerShelf">PowerShelf</a>. You may find there some related demo/test scripts and other PowerShell tools. You are welcome to submit any issues or post questions there.</p>
</body>
</html>
